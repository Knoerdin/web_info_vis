Traceback (most recent call last):
  File "/Users/nordin/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/Users/nordin/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/Users/nordin/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/Users/nordin/opt/anaconda3/envs/jupyterbook/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/Users/nordin/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/Users/nordin/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/nordin/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import pandas as pd
import plotly.graph_objects as go
import plotly.express as px

# datasets importen
df = pd.read_csv('../resources/dataset_weather/weather_accidents.csv')

# Filter the df to detroit
df_detroit = df[df['City'] == 'Detroit']

# Drop irralevant columns
df_detroit = df_detroit.drop(columns=['Severity', 'City'])

# Count the entries per day
accident_count = df_detroit['Date'].value_counts().sort_index()

df_accidents = df.drop(columns=['Severity', 'City'])
df_accidents['Date'] = pd.to_datetime(df_accidents['Date'])
df_accidents['Date'] = df_accidents['Date'].dt.month_name()
total_accidents = df_accidents['Date'].value_counts()

months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
mapping = {Date: i for i, day in enumerate(months)}
key = df['day'].map(mapping)

# Merge count with df
df_detroit_count = pd.merge(df_detroit, accident_count, left_on=['Date'], right_on=[accident_count.index])

# Group dataframe by date
df_detroit_count = df_detroit_count.groupby('Date').mean()
df_detroit_count = df_detroit_count.reset_index()

# Converting the the dates to the names of the month
df_detroit_count['Date'] = pd.to_datetime(df_detroit_count['Date'])
df_detroit_count['Date'] = df_detroit_count['Date'].dt.month_name()

# Binning so the plot will show nice catagories
df_detroit_count['Temp_bins'] = pd.cut(df_detroit_count['Temperature'], [0,275,1000], labels=['Freezing', 'Not Freezing'])
df_detroit_count['Humidity_bins'] = pd.qcut(df_detroit_count['Humidity'], q=3, labels=['Low','Medium','High'])
df_detroit_count['Wind_Speed_bins'] = pd.qcut(df_detroit_count['Wind_Speed_km'], q=3, labels=['Low','Medium','High'])
df_detroit_count['count_bins'] = pd.qcut(df_detroit_count['count'], q=3, labels=['Low','Medium','High'])


fig = px.histogram(total_accidents, x=total_accidents.index, y=total_accidents.values, title='Accidents per month in the US', labels={'Date':'Month', 'count' : 'Accidents'}, height=400)

fig.add_annotation(x=-0.05, y=-0.28,
                   xref="paper", yref="paper",
                   showarrow=False,
                   align='left',
                   xanchor='left', yanchor='bottom',
                   text='The sum of accidents in the US per month over the span of two years')

fig.show()
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mNameError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[1], line 23[0m
[1;32m     20[0m total_accidents [38;5;241m=[39m df_accidents[[38;5;124m'[39m[38;5;124mDate[39m[38;5;124m'[39m][38;5;241m.[39mvalue_counts()
[1;32m     22[0m months [38;5;241m=[39m [[38;5;124m"[39m[38;5;124mJanuary[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mFebruary[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mMarch[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mApril[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mMay[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mJune[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mJuly[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mAugust[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mSeptember[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mOctober[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mNovember[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mDecember[39m[38;5;124m"[39m]
[0;32m---> 23[0m mapping [38;5;241m=[39m {Date: i [38;5;28;01mfor[39;00m i, day [38;5;129;01min[39;00m [38;5;28menumerate[39m(months)}
[1;32m     24[0m key [38;5;241m=[39m df[[38;5;124m'[39m[38;5;124mday[39m[38;5;124m'[39m][38;5;241m.[39mmap(mapping)
[1;32m     26[0m [38;5;66;03m# Merge count with df[39;00m

Cell [0;32mIn[1], line 23[0m, in [0;36m<dictcomp>[0;34m(.0)[0m
[1;32m     20[0m total_accidents [38;5;241m=[39m df_accidents[[38;5;124m'[39m[38;5;124mDate[39m[38;5;124m'[39m][38;5;241m.[39mvalue_counts()
[1;32m     22[0m months [38;5;241m=[39m [[38;5;124m"[39m[38;5;124mJanuary[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mFebruary[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mMarch[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mApril[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mMay[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mJune[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mJuly[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mAugust[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mSeptember[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mOctober[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mNovember[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mDecember[39m[38;5;124m"[39m]
[0;32m---> 23[0m mapping [38;5;241m=[39m {[43mDate[49m: i [38;5;28;01mfor[39;00m i, day [38;5;129;01min[39;00m [38;5;28menumerate[39m(months)}
[1;32m     24[0m key [38;5;241m=[39m df[[38;5;124m'[39m[38;5;124mday[39m[38;5;124m'[39m][38;5;241m.[39mmap(mapping)
[1;32m     26[0m [38;5;66;03m# Merge count with df[39;00m

[0;31mNameError[0m: name 'Date' is not defined

